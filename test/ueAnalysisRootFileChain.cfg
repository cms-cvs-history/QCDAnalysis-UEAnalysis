process MBUEAnalysisRootFile= {

    service = TFileService { string fileName = "MBUEAnalysisRootFile.root" }
    
    ### keep the logging output to a nice level ###
#    include "FWCore/MessageService/data/MessageLogger.cfi"
    service = MessageLogger
    {
	untracked vstring destinations = {"cout"}
	untracked PSet cout = 
	{ 
	    untracked string threshold = "ERROR" 
#	    untracked string threshold = "DEBUG" 
	}
	untracked PSet cerr = 
	{ 
	    untracked PSet default = { untracked int32 limit = 10 }  
#	    untracked PSet default = { untracked int32 limit = -1 }  
	}
    }

    untracked PSet maxEvents = {untracked int32 input = -1 }

    source = PoolSource { 

	# /RelValMinBias/CMSSW_2_0_0_pre9-RelVal-1207410101-HLT/RECO
	untracked vstring fileNames = { "/store/relval/2008/4/6/RelVal-RelValMinBias-1207410101-HLT/0000/18C494D2-0B04-DD11-BF7C-000423D6B5C4.root" }
    }	

    # need to add PDTRecord in 2_0_0 
    # (used to be part of RecoJets/Configuration/data/GenJetParticles.cff)
    include "SimGeneral/HepPDTESSource/data/pythiapdt.cfi"    

    include "RecoJets/Configuration/data/GenJetParticles.cff"    

    # select charged GenParticles with pt > 0.89

    module goodParticles = GenParticleSelector {

        InputTag src = genParticles
        string cut = "pt > 0.0"
        bool stableOnly = true
        bool filter = false
    }

    module chargeParticles = GenParticleSelector {

        InputTag src = genParticles
        string cut = "charge != 0 & pt > 0.89"
        bool stableOnly = true
        bool filter = false
    }

    # select tracks with
    # pt > 0.89
    # at least 8 valid hits
    # distance of closest approach to the primary vertex <= 3.5
    # z-difference to primary vertex <= 30

    module selectTracks = TrackSelector {

        InputTag src = generalTracks
        string cut = "pt > 0.89 & numberOfValidHits > 7 & d0 <= 3.5 & dz <= 30"
    }

    module allTracks = ChargedCandidateProducer {
	InputTag src = selectTracks
	string particleType = "pi+"
    }
    
    module goodTracks = CandSelector {
	InputTag src = allTracks
	string cut = "pt > 0.89"
	bool filter = false
    }	
    #Cono 0.5 Seed 1.0

    include "RecoJets/JetProducers/data/GenJetParameters.cfi"
    include "RecoJets/JetProducers/data/IconeJetParameters.cfi"

    module iterativeCone5GenJetsSeed10 = IterativeConeJetProducer {
        untracked string alias = "IC5GenJet"
        using IconeJetParameters
        using GenJetParameters
        double coneRadius = 0.5
    }
    replace iterativeCone5GenJetsSeed10.seedThreshold = 1.0
    replace iterativeCone5GenJetsSeed10.src = goodParticles

    module iterativeCone5ChgGenJetsSeed10 = IterativeConeJetProducer {
        untracked string alias = "IC5ChgGenJet"
        using IconeJetParameters
        using GenJetParameters
        double coneRadius = 0.5
    }
    replace iterativeCone5ChgGenJetsSeed10.seedThreshold = 1.0
    replace iterativeCone5ChgGenJetsSeed10.src = chargeParticles

    module iterativeCone5BasicJetsSeed10 = IterativeConeJetProducer {
	using IconeJetParameters
	untracked string alias = "IC5BasicJet"
	untracked string jetType = "BasicJet"
	double inputEtMin = 0.
	double inputEMin = 0.
	double towerThreshold = 1.0       
	double coneRadius = 0.5
	InputTag src = goodTracks
    }

    include "QCDAnalysis/UEAnalysis/data/UEAnalysisRootple.cfi"
    replace ueAnalysisRootple.OnlyRECO = false	

    path p1 = { genJetParticles,goodParticles,chargeParticles,selectTracks,allTracks, goodTracks,
	iterativeCone5GenJetsSeed10,iterativeCone5ChgGenJetsSeed10,iterativeCone5BasicJetsSeed10,ueAnalysisRootple}

}
